<?php extend('../templates/main.html', ['title' => 'Static Scrabble']) ?>

<h1 class="mt-4 mb-1 text-3xl text-center">Static Word Game</h1>
<p class="text-xs text-center mb-4">v0.25</p>

<div x-data="scrabble" class="w-full max-w-4xl mx-auto flex flex-col items-center px-4">

    <p class="mb-4 text-center ">This is a prototype server-less Scrabble clone. Endcoded game data is passed between
        players in
        the URL. Enjoy!</p>

    <h2 class="text-center mb-2" x-text="'Welcome, Player ' + thisMovePlayerId"></h2>

    <p class="mb-2">Your score: <span x-text="thisMovePlayer.score"></span> | Opponent score: <span
            x-text="otherPlayerScore()"></span></p>
    </p>

    <div id="board" class="flex flex-col">
        <template x-for="(row, rowIndex) in board" :key="`row-${rowIndex}`">
            <div class="flex flex-row">
                <template x-for="(tile, colIndex) in row" :key="`tile-${colIndex}`">
                    <button :class="{
                            'border border-gray-300 w-6 h-6 leading-6 text-center' : true,
                            'bg-pink-200' : boardSquareIsCenterSquare(colIndex, rowIndex),
                            'bg-blue-200' : boardSquareIsInEnterLine(colIndex, rowIndex),
                            'bg-blue-300': boardSquareIsPlayedTile(colIndex, rowIndex),
                            'bg-blue-500 text-white' : boardSquareIsCurrentEnterPoint(colIndex, rowIndex)
                        }" @click="tileClick(colIndex, rowIndex)" x-text="tile"></button>
                </template>
            </div>
        </template>
    </div>

    <div id="enter-move-ui" class="w-full max-w-md mt-4">
        <div id="enter-move-ui-title" class="flex justify-between items-center mb-2">
            <h2 class="font-bold">Your tiles</h2>
            <div>
                <button class="px-2 py-1 border" @click="clearMove">Clear</button>
                <button class="px-2 py-1 border" @click="submitMove">Play</button>
            </div>
        </div>
        <div class="mb-2 flex items-center justify-center">
            <template x-for="(tile, index) in thisMovePlayer.tiles" :key="`tile-${index}`">
                <button :class="{
                            'relative w-11 h-11 leading-11 text-center border border-grey-300 rounded mx-1 text-xl font-bold': true,
                            'bg-blue-200': tileIsPlayed(index)
                        }" @click="selectPlayerTile(index)">
                    <span class="" x-text="tile"></span>
                    <span class="absolute bottom-0.5 right-1 text-xs font-normal" x-text="letterValues[tile]"></span>
                </button>
            </template>
        </div>
    </div>

    <div class="mt-4 text-center" x-show="moveIsPlayed">
        <p class="mb-2">Copy the game link below and share it with the other player.</p>
        <div class="flex justify-center mb-4">
            <button @click="copyGameUrl()" class="block px-4 py-2 mb-2 mr-2 border" x-text="copyButtonText"></button>
            <button x-show="browserHasShareApi()" @click="shareGameUrl()" class="block px-4 py-2 mb-2 border ">Share
                link</button>
        </div>
        <span class="block px-4 py-2 border break-all"
            x-text="window.location.origin + '/#' + game.encodeAsBigint().toBase64()">
        </span>
    </div>

    <div id="output-ui" class="mt-4">
        <h3 class="font-bold">Moves</h3>
        <ul class="mb-4">
            <template x-for="(move, index) in game.moves" :key="`move-${index}`">
                <li>
                    Across: <span x-text="(Move.decodeFromBigInt(move.encodeAsBigint())).acrossFlag"></span>
                    | X: <span x-text="(Move.decodeFromBigInt(move.encodeAsBigint())).x"></span>
                    | Y: <span x-text="(Move.decodeFromBigInt(move.encodeAsBigint())).y"></span>
                    | Word: <span x-text="(Move.decodeFromBigInt(move.encodeAsBigint())).word"></span>
                </li>
            </template>
        </ul>
    </div>
</div>

<?php endExtend(); ?>
