<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>
        Untitled Word Game    </title>
    <meta name="description" content="">

    <link rel="stylesheet" href="/css/styles.css">

    <!-- Facebook Meta Tags -->
    <meta property="og:url" content="">
    <meta property="og:type" content="website">
    <meta property="og:title" content="Untitled Word Game">
    <meta property="og:description" content="">
    <meta property="og:image" content="">

    <!-- Twitter Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta property="twitter:domain" content="">
    <meta property="twitter:url" content="">
    <meta name="twitter:title" content="Untitled Word Game">
    <meta name="twitter:description" content="">
    <meta name="twitter:image" content="">
</head>

<header class="">
</header>

<body>
    
<h1 class="mt-4 mb-1 text-3xl text-center">Untitled Word Game</h1>
<p class="text-xs text-center mb-4">v0.53
    - <a class="underline" href="https://github.com/rosswintle/static-word-game/">GitHub</a>
    - <a class="underline" href="https://ko-fi.com/magicroundabout">Buy me a coffee</a>
</p>

<div x-data="scrabble" class="w-full max-w-4xl mx-auto flex flex-col items-center px-4">

    <!-- Modal -->
<div x-show="swapModalOpen" style="display: none" x-on:keydown.escape.prevent.stop="closeSwapModal" role="dialog"
    aria-modal="true" x-id="['swapModal']" :aria-labelledby="$id('swapModal')"
    class="fixed inset-0 z-10 overflow-y-auto">
    <!-- Overlay -->
    <div x-show="swapModalOpen" x-transition.opacity class="fixed inset-0 bg-black bg-opacity-50"></div>

    <!-- Panel -->
    <div x-show="swapModalOpen" x-transition x-on:click="closeSwapModal"
        class="relative flex min-h-screen items-center justify-center p-4">
        <div x-on:click.stop x-trap.noscroll.inert="swapModalOpen"
            class="relative w-full max-w-2xl overflow-y-auto rounded-xl bg-white p-12 shadow-lg">
            <!-- Title -->
            <h2 class="mb-4 text-3xl text-center" :id="$id('swapModal')">Select letters to swap</h2>

            <!-- Content -->
            <div id="swap-tiles-modal-content" class="mb-2 flex items-center justify-center">
                <template x-for="(tile, index) in thisMovePlayer.tiles" :key="`tile-${index}`">
                    <button :class="{
                'relative w-11 h-11 leading-11 text-center border border-grey-300 rounded mx-1 text-xl font-bold': true,
                'bg-blue-200': tileIsSelectedForSwap(index)
            }" @click="togglePlayerTileForSwap(index)">
                        <span class="" x-text="tile"></span>
                        <span class="absolute bottom-0.5 right-1 text-xs font-normal"
                            x-text="letterValues[tile]"></span>
                    </button>
                </template>
            </div>

            <!-- Buttons -->
            <div class="mt-8 flex space-x-2 justify-center">
                <button type="button" x-on:click="closeSwapModal" class="mr-6">
                    Cancel
                </button>

                <button type="button" x-on:click="swapTilesAndSkip"
                    class="rounded-md border border-gray-200 bg-white px-5 py-2.5">
                    Swap and skip turn
                </button>
            </div>
        </div>
    </div>
</div>

    <p class="mb-4 text-center ">This is a prototype server-less Scrabble clone.<br>
        Endcoded game data is passed between players in the URL. Enjoy!</p>

    <h2 class="text-center mb-2" x-text="'Welcome, Player ' + thisMovePlayerId"></h2>

    <p class="mb-2">Your score: <span x-text="thisMovePlayer.score"></span> | Opponent score: <span
            x-text="otherPlayerScore()"></span> | Tiles: <span x-text="letterBag.length"></span></p>
    </p>

    <div id="board" class="flex flex-col">
        <template x-for="(row, rowIndex) in board" :key="`row-${rowIndex}`">
            <div class="flex flex-row">
                <template x-for="(tile, colIndex) in row" :key="`tile-${colIndex}`">
                    <button :class="{
                            'border border-gray-300 w-6 h-6 leading-6 text-center' : true,
                            'bg-pink-200' : boardSquareIsCenterSquare(colIndex, rowIndex),
                            'bg-blue-200' : boardSquareIsInEnterLine(colIndex, rowIndex),
                            'bg-blue-300': boardSquareIsPlayedTile(colIndex, rowIndex),
                            'bg-green-200': boardSquareIsLastMoveTile(colIndex, rowIndex),
                            'bg-blue-500 text-white' : boardSquareIsCurrentEnterPoint(colIndex, rowIndex)
                        }" @click="tileClick(colIndex, rowIndex)" x-text="tile"></button>
                </template>
            </div>
        </template>
    </div>

    <div id="enter-move-ui" class="w-full max-w-md mt-4">
        <div id="enter-move-ui-title" class="flex justify-between items-center mb-2">
            <h2 class="font-bold">Your tiles</h2>
            <div>
                <button class="px-2 py-1 border border-black disabled:text-gray-400 disabled:border-gray-400"
                    @click="openSwapModal" :disabled="moveIsPlayed">Skip/Swap</button>
                <button class="px-2 py-1 border border-black disabled:text-gray-400 disabled:border-gray-400"
                    @click="clearMove" :disabled="moveIsPlayed">Clear</button>
                <button class="px-2 py-1 border border-black disabled:text-gray-400 disabled:border-gray-400"
                    :disabled="! playedTilesAreValidMove()" @click="submitMove">Play</button>
            </div>
        </div>
        <div class="mb-2 flex items-center justify-center">
            <template x-for="(tile, index) in thisMovePlayer.tiles" :key="`tile-${index}`">
                <button :class="{
                            'relative w-11 h-11 leading-11 text-center border border-grey-300 rounded mx-1 text-xl font-bold': true,
                            'bg-blue-200': tileIsPlayed(index)
                        }" @click="selectPlayerTile(index)">
                    <span class="" x-text="tile"></span>
                    <span class="absolute bottom-0.5 right-1 text-xs font-normal" x-text="letterValues[tile]"></span>
                </button>
            </template>
        </div>
    </div>

    <div class="mt-4 text-center" x-show="moveIsPlayed">
        <p class="mb-2">Copy the game link below and share it with the other player.</p>
        <div class="flex justify-center mb-4">
            <button @click="copyGameUrl()" class="block px-4 py-2 mb-2 mr-2 border" x-text="copyButtonText"></button>
            <button x-show="browserHasShareApi()" @click="shareGameUrl()" class="block px-4 py-2 mb-2 border ">Share
                link</button>
        </div>
        <span class="block px-4 py-2 border break-all"
            x-text="window.location.origin + '/#' + game.encodeAsBigint().toBase64()">
        </span>
    </div>

    <div id="output-ui" class="mt-4">
        <h3 class="font-bold mb-2">Moves</h3>
        <table class="mb-4 border border-collapse text-left">
            <thead>
                <tr>
                    <th class="w-32 px-2 py-1">Player</th>
                    <th class="w-32 px-2 py-1">Word</th>
                    <th class="w-20 px-2 py-1">Score</th>
                </tr>
            </thead>
            <tbody>
                <template x-for="(move, index) in game.moves.toReversed()" :key="`move-${index}`">
                    <tr :class="{ 'bg-green-200' : index === 0 }">
                        <td class="px-2 py-1">Player <span x-text="index % 2 === 0 ? '1' : '2'"></span></td>
                        <td class="px-2 py-1"><span x-text="move.word"></span></td>
                        <td class="px-2 py-1"><span x-text="move.score"></span></td>
                    </tr>
                </template>
            </tbody>
        </table>
    </div>
</div>


    <footer class="">
</footer>
<script src="/js/CodedInt.js"></script>
<script src="/js/Player.js"></script>
<script src="/js/Move.js"></script>
<script src="/js/Game.js"></script>
<script src="/js/index.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/@alpinejs/focus@3.x.x/dist/cdn.min.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/@ryangjchandler/alpine-clipboard@2.x.x/dist/alpine-clipboard.js"
    defer></script>
<script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>

<!-- Fathom - beautiful, simple website analytics -->
<script src="https://cdn.usefathom.com/script.js" data-site="QXECTLDS" defer></script>
<!-- / Fathom -->
</body>
</html>
